---
- name: call sqlplus
  hosts: '{{ hosts }}'

  tasks:
    - name: init folder
      file:
        path: /OracalAutoDB/'{{ project }}'
        state: absent
        
    - name: git clone
      git:
        repo: https://github.com/purelydinkum/'{{ project }}'
        dest: /OracalAutoDB/'{{ project }}'
        clone: yes
        version: '{{ branch }}'

    - name: Recurse sql file add "/"
      debug:
        msg: lineinfile
     
    - name: call sqlplus
      debug:
        msg: echo /tmp/testgit/aaa.sql |.\sqlplus.exe "{{ DB_AC }}/{{ DB_PW }}@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host={{ DB_HOST }})(Port={{ DB_PORT }}))(CONNECT_DATA=(SID={{ DB_SID }})))" as {{ DB_ROLE }}
        #cammand:echo /tmp/testgit/aaa.sql |.\sqlplus.exe "{{ DB_AC }}/{{ DB_PW }}@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host={{ DB_HOST }})(Port={{ DB_PORT }}))(CONNECT_DATA=(SID={{ DB_SID }})))" as {{ DB_ROLE }}

    - name: return log
      debug:
        msg: return log
